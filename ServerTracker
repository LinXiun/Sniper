-- Place this in StarterGui > LocalScript
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Create RemoteFunction if it doesn't exist
local rf = ReplicatedStorage:FindFirstChild("GetGlobalSummary")
if not rf then
    rf = Instance.new("RemoteFunction")
    rf.Name = "GetGlobalSummary"
    rf.Parent = ReplicatedStorage
end

-- ==============================
-- GUI Setup
-- ==============================
local screenGui = Instance.new("ScreenGui", playerGui)
screenGui.Name = "PaginatedServerBrowser"

local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0, 450, 0, 500)
frame.Position = UDim2.new(1, -460, 0.5, -250)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

-- Toggle Button
local toggleBtn = Instance.new("TextButton", frame)
toggleBtn.Size = UDim2.new(0, 30, 0, 30)
toggleBtn.Position = UDim2.new(1, -35, 0, 0)
toggleBtn.Text = "‚Øà"
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextSize = 20
toggleBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

local isOpen = true
toggleBtn.MouseButton1Click:Connect(function()
    isOpen = not isOpen
    frame.Size = isOpen and UDim2.new(0, 450, 0, 500) or UDim2.new(0, 40, 0, 30)
    toggleBtn.Text = isOpen and "‚Øà" or "‚Øá"
end)

-- Title
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, -40, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
title.Text = "üåê Server Browser"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.TextXAlignment = Enum.TextXAlignment.Left
title.RichText = true

-- Search Box
local searchBox = Instance.new("TextBox", frame)
searchBox.Size = UDim2.new(1, -40, 0, 30)
searchBox.Position = UDim2.new(0, 0, 0, 30)
searchBox.PlaceholderText = "Search player..."
searchBox.Text = ""
searchBox.ClearTextOnFocus = false
searchBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
searchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
searchBox.Font = Enum.Font.SourceSans
searchBox.TextSize = 16

-- Refresh Button
local refreshBtn = Instance.new("TextButton", frame)
refreshBtn.Size = UDim2.new(0, 50, 0, 24)
refreshBtn.Position = UDim2.new(1, -60, 0, 3)
refreshBtn.Text = "‚Üª"
refreshBtn.Font = Enum.Font.SourceSansBold
refreshBtn.TextSize = 18
refreshBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
refreshBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Scrolling Frame for servers
local scrollingFrame = Instance.new("ScrollingFrame", frame)
scrollingFrame.Size = UDim2.new(1, 0, 1, -60)
scrollingFrame.Position = UDim2.new(0, 0, 0, 60)
scrollingFrame.BackgroundTransparency = 1
scrollingFrame.ScrollBarThickness = 8

local UIListLayout = Instance.new("UIListLayout", scrollingFrame)
UIListLayout.Padding = UDim.new(0, 3)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- ==============================
-- Functions
-- ==============================

local function createServerEntry(serverIndex, samplePlayers)
    local container = Instance.new("Frame", scrollingFrame)
    container.Size = UDim2.new(1, -10, 0, 20)
    container.BackgroundTransparency = 1

    local label = Instance.new("TextLabel", container)
    label.Size = UDim2.new(1, 0, 0, 20)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(200, 200, 200)
    label.Font = Enum.Font.SourceSans
    label.TextSize = 16
    label.Text = string.format("Server %d sample: %s", serverIndex, table.concat(samplePlayers, ", "))
    label.TextXAlignment = Enum.TextXAlignment.Left

    local viewMore = Instance.new("TextButton", container)
    viewMore.Size = UDim2.new(0, 80, 0, 20)
    viewMore.Position = UDim2.new(1, -85, 0, 0)
    viewMore.Text = "View More"
    viewMore.Font = Enum.Font.SourceSansBold
    viewMore.TextSize = 14
    viewMore.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    viewMore.TextColor3 = Color3.fromRGB(255, 255, 255)

    -- Pagination: expand sample players
    viewMore.MouseButton1Click:Connect(function()
        local prompt = Instance.new("TextLabel", container)
        prompt.Size = UDim2.new(1, 0, 0, 20)
        prompt.Position = UDim2.new(0, 0, 0, 22)
        prompt.BackgroundTransparency = 1
        prompt.TextColor3 = Color3.fromRGB(150, 150, 150)
        prompt.Font = Enum.Font.SourceSans
        prompt.TextSize = 14
        prompt.Text = "Additional players loaded (pagination placeholder)"
    end)
end

local function refresh()
    local success, data = pcall(function()
        return rf:InvokeServer()
    end)
    if not success or not data then return end

    local filterText = searchBox.Text:lower()

    -- Clear old entries
    for _, child in ipairs(scrollingFrame:GetChildren()) do
        child:Destroy()
    end

    -- Header
    local header = Instance.new("TextLabel", scrollingFrame)
    header.Size = UDim2.new(1, -10, 0, 20)
    header.BackgroundTransparency = 1
    header.TextColor3 = Color3.fromRGB(255, 255, 0)
    header.Font = Enum.Font.SourceSansBold
    header.TextSize = 16
    header.Text = string.format("Servers: %d | Players: %d", data.TotalServers or 0, data.TotalPlayers or 0)
    header.TextXAlignment = Enum.TextXAlignment.Left

    -- List servers with sample players
    if data.SamplePlayers then
        for i, name in ipairs(data.SamplePlayers) do
            if name:lower():find(filterText) then
                createServerEntry(i, {name})
            end
        end
    end

    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, (#scrollingFrame:GetChildren()) * 25)
end

-- Connect events
refreshBtn.MouseButton1Click:Connect(refresh)
searchBox:GetPropertyChangedSignal("Text"):Connect(refresh)

-- Auto-refresh every 30s
refresh()
while task.wait(30) do
    refresh()
end